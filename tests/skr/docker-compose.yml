version: '3'
services:
  proxy:
    image: $REGISTRY/skr/proxy:$TAG
    network_mode: "host"
    build:
      context: .
      dockerfile: proxy.Dockerfile
  http_sidecar:
    image: $REGISTRY/skr/http_sidecar:$TAG
    network_mode: "host"
    build:
      context: ../../
      dockerfile: docker/skr/Dockerfile.skr
  grpc_sidecar:
    image: $REGISTRY/skr/grpc_sidecar:$TAG
    network_mode: "host"
    environment:
      - "ServerType=grpc"
      - "Port=50000"
    build:
      context: ../../
      dockerfile: docker/skr/Dockerfile.skr
